@Library('ultra-lib@1.3.1') _

pipelineBaseMonorepo(
  applyBranch: 'pull-61',
  monorepoRoot: 'forms',
  sharedConfig: [
    app: 'ultra',
    helm: [
      chartName: 'sikur-forms-chart',
      repoName: 'sikur-devops',
      branch: 'main',
    ],
    hasUnitTest: false,
    hasSonar: false,
    alwaysRunWhenChanged: ['formsJenkinsfile', 'serverDockerfile', 'clientDockerfile'],
  ],
  environments: [
    [ environment: 'test', condition: { env.BRANCH_NAME == 'develop' }, tag: "test-${env.BUILD_ID}" ],
    [ environment: 'release', condition: { env.BRANCH_NAME ==~ /^release-\\d+\\.\\d+$/ }, tag: "${env.BRANCH_NAME}-${env.BUILD_ID}" ],
    [ environment: 'prod', condition: { env.BRANCH_NAME == 'main' }, tag: "prod-${env.BUILD_ID}" ]
  ],
  forms: [
    [ name: 'client-forms',],
    [ name: 'forms-api-gateway',],
  ]
)
